{% extends 'template.html' %}


{% block content %}


<div class="card" style="margin-top: 10px;">
    <div class="card-body">
      <h5 class="card-title">{{ question.title }}</h5>
      <p>{{ question.content|safe }}</p>
      <div class="row">
        <a href="#" class="col-md-6 text-left">{{ question.author.username }}</a>
        <div class="col-md-6 text-right">
          {% if request.user == question.author %}
            <a href="{% url 'QA:question_edit' id=question.id  %}" class="btn btn-primary">Edit</a>  
            <a href="{% url 'QA:question_delete' id=question.id %}" class="btn btn-danger">Delete</a>  
        {% endif %}  
          
        </div>
      </div>

    </div>
  </div> 


    <!-- <button class="js-bookmark-btn s-btn s-btn__unset c-pointer py4 js-gps-track" 
            data-controller="s-tooltip" data-s-tooltip-placement="right" title="Bookmark this question."
            aria-pressed="false" aria-label="Bookmark (34)" data-selected-classes="fc-yellow-600"
            data-gps-track="post.click({ item: 1, priv: -1, post_type: 1 })">
        <svg aria-hidden="true" class="svg-icon iconBookmark" width="18" height="18" viewBox="0 0 18 18"><path d="M6 1a2 2 0 00-2 2v14l5-4 5 4V3a2 2 0 00-2-2H6zm3.9 3.83h2.9l-2.35 1.7.9 2.77L9 7.59l-2.35 1.7.9-2.76-2.35-1.7h2.9L9 2.06l.9 2.77z"/></svg>
        <div class="js-bookmark-count mt4" data-value="34">34</div>
    </button> -->



    <!-- <a class="js-post-issue grid--cell s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/4106809/timeline" data-shortcut="T" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18" viewBox="0 0 19 18"><path d="M3 9a8 8 0 113.73 6.77L8.2 14.3A6 6 0 105 9l3.01-.01-4 4-4-4h3L3 9zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10V5z"/></svg></a> -->



  <p>{{ question.content }}</p>



    {% for answer in answers %}

    <div class="card w-75" style="margin-top: 10px;">
        <div class="card-body">
            <p>{{ answer.content|safe }}</p>

          <div class="row">
            <a href="#" class="col-md-6 text-left">{{ answer.author.username }}</a>
            {% if request.user == answer.author %}
              <div class="col-md-6 text-right">
                <a href="{% url 'QA:answer_edit' q_id=question.id a_id=answer.id %}" class="btn btn-primary">Edit</a>  
                <a href="{% url 'QA:answer_delete' q_id=question.id a_id=answer.id %}" class="btn btn-danger">Delete</a>  
              </div>
            {% endif %}
          </div>

            <div class="row">
                {% if request.user == question.author %}
                    <input type="checkbox" id="approved" name="approved" value="Bike">
                    <label for="approved"> Approve </label><br>
                {% endif %}

            </div>    

        </div>
      </div> 





    {% empty %}

        <p>There is no answer for this question</p>

    {% endfor %}
        


    {% if user.is_authenticated and not user_answered %}
        <h3>Write answer to this question</h3>

        <form method="post" action="" enctype="multipart/form-data">
        
            {% csrf_token %}
            {{ answer_form.media }}
            {{ answer_form.as_p }}

            <input type="submit" name="submit" value="Submit" />

        </form>



    {% endif %}
    
    

  <div id="demo">
    <h2>Let AJAX change this text</h2>
    <button type="button" onclick="loadDoc()">Change Content</button>
  </div>



  <div>
    <div class="votecell post-layout--left">
      {% csrf_token %}
      <button id="vote-up" class="grid--cell s-btn s-btn__unset c-pointer" 
        data-href="{{ question.get_rate_url }}"
        data-question="{{ question.id }}"
        data-controller="s-tooltip" data-s-tooltip-placement="right" title="This question shows research effort; it is useful and clear" aria-pressed="false" aria-label="Up vote" data-selected-classes="fc-theme-primary"><svg aria-hidden="true" class="m0 svg-icon iconArrowUpLg" width="20" height="20" viewBox="0 0 36 36"><path d="M2 26h32L18 10 2 26z"/></svg></button>
    <div id="counter" class="js-vote-count grid--cell fc-black-500 fs-title grid fd-column ai-center" itemprop="upvoteCount" data-value="118">{{ question.getLikeState }}</div>
      {% csrf_token %}
      <button id="vote-down" class="grid--cell s-btn s-btn__unset c-pointer" 
        data-href="{{ question.get_rate_url }}"
        data-question="{{ question.id }}" 
        data-controller="s-tooltip" data-s-tooltip-placement="right" title="This question does not show any research effort; it is unclear or not useful" aria-pressed="false" aria-label="Down vote" data-selected-classes="fc-theme-primary"><svg aria-hidden="true" class="m0 svg-icon iconArrowDownLg" width="20" height="20" viewBox="0 0 36 36"><path d="M2 10h32L18 26 2 10z"/></svg></button>
  </div>









{% block scripts %}
  
 <script>
  $(document).ready(function(){
    
    $('#vote-up').click(function(event){
    event.preventDefault()
    var likeUrl = $(this).attr("data-href")
    var _id     = $(this).attr("data-question")
    var _state  = "True"
    $.ajax({
      url: likeUrl,
      method: "POST",
      data: {id:_id, state:_state, csrfmiddlewaretoken: $('input[name="csrfmiddlewaretoken"]').val() },
      }).done(function(){
        $("#counter").load(location.href + " #counter")
      });
    });


    $('#vote-down').click(function(event){
      event.preventDefault()
      var likeUrl = $(this).attr("data-href")
      var _id     = $(this).attr("data-question")
      var _state  = "False"
      $.ajax({
        url: likeUrl,
        method: "POST",
        data: {id:_id, state:_state, csrfmiddlewaretoken: $('input[name="csrfmiddlewaretoken"]').val() },
      }).done(function(){
        $("#counter").load(location.href + " #counter")
      });
    });

   })


 </script>
{% endblock scripts %}
  






{% endblock content %}
    


